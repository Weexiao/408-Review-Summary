# 一些重点协议

## 物理层

Rj45，802.3

## 数据链路层

SDLC，HDLC，PPP，STP和帧中继等

### 随机访问介质访问控制

## 网络层

- IP
- IPX
- ICMP
- IGMP
- ARP
- RARP
- OSPF

## 传输层

- TCP
- UDP

## 应用层

- FTP
- SMTP，POP3
- HTTP
- DNS



# TCP/IP模型各层总结



# 一些重要地址

## MAC地址

## IP地址

## 端口号



# 一些重要设备

## 网络层

### 路由器

## 链路层

### 网桥

### 交换机

## 物理层

### 中继器

功能：对信号进行再生和复制，对衰减的信号进行放大，保持与原数据相同，以增加信号传输距离，延长网络长度；==放大数字信号，仅作用于信号的电气特性==

> 使用双绞线传输数字信号时，使用中继器对其进行放大
>
> 使用双绞线传输模拟信号时，使用放大器对其进行放大

通信双方：中继器有两端，且两端的网络部分是网段，不是子网

- 适用于完全相同的网端的互连，且两个网段的速率要完全一致
- 只将任何电缆上的数据发送到另一端上，仅作用于信号的电气特性，并不管数据中是否有错误数据或不适用于网段的数据

> 两端可连相同媒体，或不同媒体(有线连有线，有线连无线)

5-4-3规则(10BASE5)：互相串联的**中继器个数不能超过4个**，而且用4个中继器串联的**5端通信介质**中只有**3段可以连计算机**，其余用来扩展通信范围的链路端。

### 集线器(多口集线器)

功能：还是对信号进行放大转发

> 不具备信号的定向传递能力，是一个共享设备

常用在星型拓扑中，信号可能冲突

## 总结

|    作用范围    | 冲突域 | 广播域 |
| :------------: | :----: | :----: |
|   物理层设备   |   ×    |   ×    |
| 数据链路层设备 |   √    |   ×    |
|   网络层设备   |   √    |   √    |

冲突域：同一冲突域中，每个节点都能收到被发送的数据帧；同一时间只能有一台设备发送信息的范围

广播域：网络中能收到任何一台设备发出的广播帧的设备的集合；某站点发出一个广播信号，所有能接受这个信号的设备范围

# 一些重要数据结构

1. 虚电路表

	用来维持虚电路

	每一块都记录一个打开的虚电路的信息

# 物理层

## 通信基础

多为选择题，重点是==奈奎斯特定理和香农定理、编码与调制技术、数据交换方式，以及电路交换、报文交换与分组交换技术等==

### 基本概念

#### 数据通信相关术语

1. 数据

   传递信息的实体，通常是有意义的二进制序列

2. 数据通信

   在不同计算机之内传输表示信息的二进制序列的过程

3. 信号

   数据的电气/电磁表现，是数据在信道上的存在形式

   可分为：

   - 数字信号(离散信号)：代表信号的参数取值是离散的

   - 模拟信号(连续信号)：代表信号的参数取值是连续的

     ==发什么信号由信道决定，信道是离散的就发离散信号==

4. 信源

   信号源头

5. 信宿

   信号目的地

6. 信道

   信号的传输媒介；

   Note: 一般用来表示向某一端传输信息的介质，故一条通信线路有一条发送信道和一条接受信道

   分类：

   - 按传输信号分：模拟信道(模拟信号)、数字信道(数字信号)
   - 按传输介质分：无线信道(Wifi)、有线信道(双绞线)

#### 三种通信方式

1. 单工(你说我听)

   一方只能发，另一方只能收，故一条信道

2. 半双工(我一句你一句)

   双方都能收发，但同时只能一方发另一方收，两条信道

3. 全双工(一起说)

   双方可同时收发

#### 数据传输方式

1. 并行传输

   将表示一个字符的8位二进制数同时通过8条信道发送

   特点：速度快，费用高，适合近距离

   多用在计算机内部数据传输

   ```mermaid
   %%{init:{'theme':'base', 'themeVariables':{'fontSize':'8px'}}}%%
   graph LR
   A[发送方]--0-->B[接受方]
   A--其他字符-->B
   A--1-->B
   ```

   

2. 串行传输

   将表示一个字符的8位二进制数按位依次发送

   特点：速度满，费用低，适合远距离

   ```mermaid
   graph LR
   A[发送方]--00001111-->B[接受方]
   ```

   

#### 同步 or 异步传输(实现字符同步方法)

1. 同步传输

   数据的传输以一个数据区块为单位，故也叫区块传输

   在传输数据时，先发出1个或多个同步字符，在发数据

2. 异步传输

   将比特拆分为小组传输，发送方可以在任意时刻发送，接收方不确定什么时候到达

   在发送时数据加上起始位和结束位

​	为什么实现字符同步？

​	需要知道数据的开头、内容、结尾等

#### 速率有关概念

1. 码元

   概念：是指用一个固定时长的信号波形(数字脉冲)，代表不同离散数值的基本波形

   码元是数字通信中数字信号的计量单位，这个时长内的信号称做k进制码元，而该时长称为码元宽度

   当码元的离散状态有M个时(M>2)，此时码元为M进制码元

   Note: 1码元可以携带多个比特的信息量

   > 二进制码元只有0、1两种状态，故其信息量为1比特
   >
   > 四进制码元则有00、01、10、11四种状态，故其信息量为2比特
   >
   > $2^n$进制码元信号量便有$n$比特

2. 速率

   可分为码元传输速率和信息传输速率

   - 码元传输速率(波特率)

     **单位时间内数字通信系统所传输的码元个数(脉冲个数或信号变化次数)**，单位是波特 B

     码元传输速率与码元进制数无关，只与码元长度T有关

     $$R_B=\frac{1}{T}B$$

   - 信息传输速率

     单位时间内数字通信系统所传输的码元所含信息数，单位为比特/秒 b/s

   - 二者关系

     若一个码元携带$n$ bit的信息量，则$M$ B的码元传输速率对应的信息传输速率为$M*n$ bit/s

3. 带宽

   表示单位时间内从网络的一点到另一点所能通过的最高数据率在一单位时间内通过链路的数量，单位是bps（比特每秒）

### 奈奎斯特定理与香农定理

只有此处带宽为Hz

#### 失真

![image-20220726210614672](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220726210614672.png)

#### 奈氏准则(奈奎斯特定理)

限制码元极限传输速率

**在理想低通(无噪音 带宽受限)条件下，为了避免码间串扰，极限码元传输速率为$2W$Band，W为信道带宽(Hz)；故极限数据传输速率为$2Wlog_2V$b/s，V为码元进制数**

Note:

1. 在任何信道上，码元传输速率都有上限，否则会出现码间串扰线性
2. 信道的带宽越宽(能通过的信号频数越多)，就可以用更高的速率(W越大码元速率越大)进行码元的传输
3. 奈式准则只限制了码元传输速率，没有限制数据传输速率
4. 由于码元传输速率受奈氏准则规约，故要提高数据传输速率，可以设法让码元携带更多的比特信息量，即提高码元进制数

#### 香农定理

信噪比：用来衡量噪声对信号的影响

$$信噪比=\frac{信号的平均速率}{噪声的平均速率}$$ 记为 $\frac{S}{N}$，并用分贝(dB)作为单位，即$信噪比(dB)=10log_{10}\frac{S}{N}$

香农定理

在带宽受限且有噪声的信道中，为了不产生误差，数据传输速率有上限值，一般给定信噪比dB求$\frac{S}{N}$
$$
信道的极限数据传输速率=W*log_2(1+\frac{S}{N}) \qquad (b/s)
\tag{1}
$$
Notes:

1. 信道的带宽或信道中信噪比越大，极限数据传输速率越大
2. 传输带宽与信噪比确定后，极限数据传输速率确定
3. 只要信息传输速率低于信道极限信息传输速率，总有方式让数据无差错传输
4. 实际的信道传输速率远低于信道极限信息传输速率

> 若题中有信噪比，则奈氏准则和香农定理各求一次，取其数据传输速率最小值

### 编码与调制

#### 基带信号与宽带信号

信道上传输的信号的两种形式，与数字、模拟信号是两种分类方式

1. 基带信号：将数字信号0、1用两种不同电压表示，再送到数字信道上传输(基带传输)

	> 一般来说基带信号就是发出的直接表达要传输信息的信号
	>
	> 距离近

2. 宽带信号：将基带信号进行调制后形成的==频分复用模拟信号==，再传到==模拟信道==上进行传输(宽带传输)

	> 距离源

#### 编码与调制

编码：用在基带传输，规定0、1表示方法

调制：将基带信号转成宽带信号

![编码和调制](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/%E7%BC%96%E7%A0%81%E5%92%8C%E8%B0%83%E5%88%B6.png)

### 电路交换、报文交换与分组交换

![三种交换方式](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/%E4%B8%89%E7%A7%8D%E4%BA%A4%E6%8D%A2%E6%96%B9%E5%BC%8F.png)

#### 电路交换

原理：在数据传输期间，在源节点和目的节点之间建立一条由中间节点组成的==专用物理链路==，在数据传输结束前，该链路一直存在

阶段

```mermaid
graph LR
A[建立连接 呼叫或电话建立]-->B[通信 电路传输]-->c[释放连接 拆分电路]
```

特点

- 独占资源，在这条链路上用户始终占用
- 适用于远程批处理系统或对实时性要求很高的大量数据传输系统

优缺点

|                             优点                             |                             缺点                             |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
|                          传输时延小                          |                        建立连接事件长                        |
|                   数据顺序到达，无失序问题                   | 线路独占，即使目前线路空闲，其他用户也无法使用，信道使用效率低 |
| 实时性强，双方一旦建立物理通路，便可以实时通信，适用于交互式会话类通话 | 灵活性差，双方连接通路中的任意一点宕机，便必须重新拨号建立新连接，不适应突发通信 |
| 全双工通信，没有冲突，通信双方有不同的信道，不会争用物理信道 |                无数据存储能力，难以平滑通信量                |
|                   适用于数字信号和模拟信号                   | 电路交换时，数据直达，不同类型、不同规格、不同速率的终端很难相互进行通信 |
|             控制简单，电路的交换设备及控制较简单             |     无法发现与纠正传输差错，难以在通信过程中进行差错管理     |

例子

![image-20220728193127989](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220728193127989.png)

#### 报文交换

报文：网络中交换与传输的数据单元，即站点一次性要发送的数据块；包含了将要发生的完整的数据信息，==其长短很不一致，长度不限且可变==

原理：无需在传输过程中建立物理链路，其数据传输单位为报文；使用存储转发技术

- 每个节点收下整个报文后，暂存报文并检查有无错误
- 当所需的输出链路空闲时，利用路由信息找到下一个节点地址，传输到下一个节点
- 在两个通信用户之间其他线路段可传输其他用户的报文，不独占

优缺点

|                             优点                             |                             缺点                             |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
|       无需建立连接，无建立链接时延，用户可随时发送报文       | 实时性差，不适合传输实时或交互式业务的数据，数据进入交换节点后要经历存储转发过程，从而引起转发时延 |
|   动态分配线路，动态选择报文通过的最佳路径，可以平滑通信量   |                     ==只适用于数字信号==                     |
|          提高线路可靠性，某条链路宕机可选用其他线路          |                                                              |
|                  提高线路利用率，线路不独占                  |                                                              |
|           提供多目标服务，一个报文可到达多个目的地           |                                                              |
| 在存储转发中容易实现代码转换和速率匹配，甚至收发双方可以不同时处于可用状态，便于计算机通信 | 由于报文长度没有限制，而每个中间节点都要完整的接受传来的整个报文，当输出线路不空闲时，还可能要存储多个完整报文等待转发，要求网络中每个节点有较大的缓冲区，为了介绍成本，有时候要把等待转发的报文存在硬盘上，增大了传输时延 |

#### 分组交换

分组：将任意长度的报文划分为等长的小块，然后成块的发送

原理：与报文传输基本类似，只是将传输单元从任意长的报文改为固定长的分组

- 分组一般长为**128B**，以分组为单位进行传输和接收
- 发送节点将数据划分为一定长度的分组，接受节点将报文组装后发送给上层
- 分组=小数据块+控制信息(源地址+目的地址+分组序号)

优缺点

|                             优点                             |                             缺点                             |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
|       无需建立连接，无建立链接时延，用户可随时发送分组       | 比报文传输好一点，但还有存储转发时延，且结点交换机处理能力要求更强 |
|                         线路利用率高                         | 每个分组都要加控制信息，一定程度上降低了通信效率，增加了处理事件 |
|               简化了存储管理，因为分组长度固定               |                                                              |
| 加速存储，后一个分组的存储可以和前一个分组的转发并发操作；传输一个分组比一个报文所需缓冲区小 |                                                              |
|      减少出错几率和重发数据量，提高可靠性，减少传输时延      |                                                              |
|                   分组短小，适用于突发通信                   | 当**分组交换使用数据报传输**时，可能出现失序、丢失或重复分组，分组到达目的地时要对分组排序；若**使用虚电路传输**，虽无失序问题，但有呼叫建立、数据传输、释放虚电路三个阶段 |

#### 数据传输方式选择

- 传输数据量大，且传送事件远大于呼叫时间，采用电路交换(电路时延最小)
- 端到端的通路有很多段的链路组成，采用分组交换
- 从信道利用率上来看，==**报文交换与分组交换优于电路交换，其中分组交换更优，尤其适合于计算机之间的突发通信**==
- ![image-20220728195213802](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220728195213802.png)

### 数据报传输和虚电路传输

#### 数据报传输

传输过程

> ![image-20220728195525016](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220728195525016.png)

1. 源主机(A)将报文分成多个分组，依次发送到直接相邻的结点A

2. 结点A对每个分组进行**差错检验和路由选择**，不同分组的下一站可能不同

3. 结点C收到$P_1$后，对$P_1$进行差错检验(其他结点同理)

	若正确则对A发确认信息，A收到确认后丢弃A副本

	若错误则让A重发

4. 分组到达B

特点

1. 用发送方提供无连接服务，发送方可随时发送，接收方可随时接收
2. 同一报文的不同分组到达目的结点时可能失序、重复或丢失
3. 每个分组都有**源+目的地址+分组序号**
4. 分组在存储转发时，需要排队等候，会带来排队时延。当通过交换结点的通信量较大或网络发送拥堵时，这种时延会大大增加，交换结点还可能会丢弃一些分组
5. 网络存在冗余路径，适用于突发性通信、不适用于长报文、会话式通信

#### 虚电路传输

> 传输过程
>
> ![image-20220729194525853](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220729194525853.png)

存在永久虚电路(PVC)和零食虚电路(SVC)两种

将数据包和电路交换形式相结合

虚电路：一条源主机到目的主机的类似于电路的**逻辑路径**；路径中所有结点都需要维持这条虚电路的建立，都维持一张**虚电路表(具体见上)**

特点

1. 提供连接服务，源节点与目的节点之间建立逻辑连接
2. 一个通信的所有分组都通过虚电路顺序发送，==**分组不携带源地址、目的地址等信息，但包括虚电路号**==；相对数据报方式开销小，同一报文的不同分组到达目的节点不会失序、重复或丢失
3. 分组通过虚电路上每个节点时，**进行差错检验**不进行路由选择
4. **每个节点可能和多个节点之间建立多条虚电路**，每条虚电路支持特点的两个系统之间的数据报传输，可以对两个数据端点的流量进行控制，**两个端系统之间也可能有多条虚电路，为不同进程服务**。
5. 缺点是：当网络中的某个节点或链路宕机时，所有经过该节点或链路的虚电路都被破坏

#### 二者对比

|                    |                         数据报服务                         |                        虚电路服务                        |
| :----------------: | :--------------------------------------------------------: | :------------------------------------------------------: |
|     连接的建立     |                           不需要                           |                           需要                           |
|      目的地址      |                   每个分组都携带目标地址                   |           不需要携带目标地址，只需要带虚电路号           |
|      路由选择      |               在每个通信节点都要进行路由选择               | 不需要，链路建立时便已经路由选择好了，其他时候直接发就OK |
|      分组顺序      |                         不保证顺序                         |                          不失序                          |
|       可靠性       |                  不可靠，可靠性由用户保证                  |                     可靠性由网络保证                     |
| 对网络故障的适应性 | 出故障的节点丢失分组，其他分组路径选择发送变化，可正常传输 |          所有经过故障节点的虚电路均不能正常工作          |
| 差错处理和流量控制 |            由用户主句保证流量控制，不保证可靠性            |              可以由网络负责，可也由用户负责              |

#### ==三种交换时延计算方法==

1. 四种时延
	$$
	发送时延(传播时延)=\frac{数据块长度(bit)}{数据率(b/s)} \\
	传输时延=\frac{链路长度(m)}{传播速度(m/s)} \\
	处理时延=节点存储转发所用时间 \\
	排队时延=节点排队时间
	\tag{1}
	$$
	1在发送器中，2在链路上，34在节点中
	
2. 电路交换
	$$
	时延=建立连接时延+传输时延+传播时延 \quad (没有存储转发)
	\tag{2}
	$$
	
3. 报文交换
	$$
	发送时延(传播时延)=\frac{数据块长度(bit)}{数据率(b/s)} \\
	传输时延=\frac{链路长度(m)}{传播速度(m/s)} \\
	处理时延=节点存储转发所用时间=单个节点处理时延*节点数 \\
	排队时延=节点排队时间=单个节点排队时延*结点数
	\tag{3}
	$$
	
4. 分组交换
	$$
	发送时延(传播时延)=\frac{总分组长度(bit)}{数据率(b/s)}+节点数*\frac{单个分组长度(bit)}{数据率(b/s)} \\
	传输时延=\frac{链路长度(m)}{传播速度(m/s)} \\
	处理时延=最后一个节点的排队时延 \\
	排队时延=一个分组的排队时延
	\tag{4}
	$$

## 传输介质

### 双绞线、同轴电缆、光纤和无线传输介质

传输介质(传输媒体/传输媒介)：数据传输过程中在发送设备和接受设备之间的物理通路

> Note：不是物理层，可看作第0层
>
> 分类：
>
> - 导向性传输介质：电磁波导向沿着固体媒介传输
> - 非导向性传输介质：自由传输

#### 双绞线(常用)

概念：由两根采用一定规则并排绞合的，相互绝缘的铜导线组成

分类：绞合可以减少对相异导线的电磁干扰

![image-20220729195325918](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220729195325918.png)

> 双绞线价格便宜，是最常用的传输介质之一，在局域网和传统电话网中普通使用。模拟传揄和数字传输都可以使用双绞线，其通信距离一般为几公里到数十公里。距离太远时，对于**模拟传输**，要用**放大器**放大衰减的信号：对于数字传输，要用中继器将失真的信号整形

#### 同轴电缆

> ![image-20220729200141960](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220729200141960.png)

#### 光纤

> ![image-20220729200159410](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220729200159410.png)
>
> ![image-20220729200214910](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220729200214910.png)

#### 无线传播介质

> ![image-20220729200230559](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220729200230559.png)

### 物理层接口特性

> ![image-20220729200335844](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220729200335844.png)

## 物理层设备

见上

# 数据链路层

重点掌握==滑动窗口机制、三种可靠传输协议、各种MAC协议，HDLC协议和PPP协议，特别是**CSMA/CD协议和以太网帧格式，以及局域网的争用期和最小帧长的概念、二进制指数退避算法**==。此外，==中继器、网卡、集线器、网桥和局域网交换机的原理及区别==也要重点掌握

## 数据链路层的功能

### 概述

定义

- 结点：主机、路由器
- 链路：两结点之间的物理通路，传输介质主要为有线(双绞线、同轴电缆)或无线
- 数据链路：两结点之见的逻辑通路，把实现控制数据传输协议的硬件和软件加到链路上便是数据链路
- 帧：数据链路层传输的最小单位，封装网络层数据报

作用：数据链路层负责通过一条链路向另一个物理链路直接相连的相邻结点传输数据

> ![image-20220731194518687](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220731194518687.png)

功能

1. 为网络层提供服务

	> 三种服务：
	>
	> - 无确认无连接的服务：实时传输，误码率低
	> - 有确认无连接的服务：收到消息确认，超时重传，使用无线传输时误码率高
	> - 有确认有连接的服务：安全可靠

2. 建立、维持、销毁链路

3. 组帧

4. 流量控制：发送方少发

5. 差错控制：帧错或位错

## 封装成帧和透明传输

### 封装成帧

主要指在帧前后加上帧首部和帧尾部，组成帧

> 接收端在收到帧后，就可以通过帧首部和帧尾部(包含很多控制信息，其中帧定界符用来确定帧的界限)来从数据流中取出帧

帧同步：指接收方应当能从比特流中区分帧的起始和结束

组帧的方法

- ![image-20220731195429306](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220731195429306.png)

### 透明传输

指不管所传数据是什么样的比特流，都应当能在链路上传输

### 组帧方法

#### 字符计数法

帧首部用一个计数手段(第一个字节)表示帧内字符数(包括首部)

cons：若首部出错则后面所有帧都出错

#### 字符(节)填充法

在帧首部、帧尾部分别插入SOH(start of header)、EOT(end of transmission)，两个标识元素均为一个字符大小 

1. 当帧传输文本文件(键盘输入)时，十分简单直接插入标识元素即可

2. 当帧传输非ASCII码的文件时，就要采用字符填充法

	文件数据中可能会出现与SOH、EOT、ESC相同的字符，使用转义字符(ESC)来解决问题

> ![image-20220801192034650](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220801192034650.png)

#### 零比特填充法

允许数据帧中包含任意个数的比特，首尾标识符一样为01111110

保证了透明传输；在传送的比特流中可以传输任意的比特组合而不会引起帧边界的判断错误

> ![image-20220801192911846](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220801192911846.png)

#### 违规编码法

物理层进行比特编码时常用违规编码法，如曼彻斯特编码使用“高-低”表示1、“低-高”表示0，此时“高-高”和“低-低”在数据比特中便是违规的，使用这两个信号就可用来做定界帧的起始和终止。

现在常用比特填充法和违规编码法

## 差错控制

![差错](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/%E5%B7%AE%E9%94%99-16593538419162.png)

### 检错编码

检错编码都使用了冗余编码技术

> 冗余编码：在数据发送前，先按一定规律附加上冗余位，构成一个符合某一规则的码字后发送。在发送的数据变化时冗余位也会相应的变化，接收方按照收到的码字是否遵循原规则，从而判断是否出错

#### 奇偶校验码

![奇偶校验码](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/%E5%A5%87%E5%81%B6%E6%A0%A1%E9%AA%8C%E7%A0%81.png)

检验出错能力差，若信息有偶数位变化就检验不出来了

#### 循环冗余码

![image-20220801194550057](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220801194550057.png)

> 若要发送的数据是1101 0110 11，使用CRC校验，生成多项式为10011，那要发送的数据是
>
> ![image-20220801195414108](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220801195414108.png)
>
> 接收方验证过程如下：
>
> ![image-20220801195843238](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220801195843238.png)

FCS生成以及接受端CRC校验都由硬件实现，处理迅速，不会延误数据传输；但==数据链路层仅仅使用循环冗余检验CRC差错检测技术只能做到对帧的无差错接受，而出错的帧将直接丢弃，故还达不到可靠传输(发什么就收什么)==

### 纠错编码(海明码)

$确认校验码位数r \to 确认校验码和数据的位置 \to 求出校验码的值 \to 检错并纠错$

#### 海明距离(码距)

两个合法编码(码字)的对应比特取值不同的比特数即为==两个码字的海明距离(码距)==

一个有效编码集中，任意两个合法编码的海明距离的最小值称为==该编码集的海明距离(码距)==

> 编码系统：000、001、010、011、100、101、110、110码距为1
>
> 编码系统：0000、1001、1010、0011、1100、0101、0110、1111码距为2

检测$\alpha$位错误需要$\alpha+1$个校验值，纠错$\alpha$位错误需要$2\alpha+1$个校验值

#### 纠错过程

以数据为1010举例

1. 确定校验码位数$r$

  数据/信息有m位，冗余码/校验码有r位，故校验码有$2^r$个取值，为了检错$\alpha$位错误需要$\alpha+1$个校验值，故$2^r \ge m+r+1$

  对1010来说$m=4, \quad r=3$，设信息位为$D_4D_3D_2D_1(1010)$，校验位为$P_3P_2P_1$，海明码就为$H_7H_6H_5H_4H_3H_2H_1$

2. 确定校验码和数据位的分布

  校验码应位于$2^i$位

  |  $H_7$   |  $H_6$   |  $H_5$   | $H_4$ |  $H_3$   | $H_2$ | $H_1$ |
  | :------: | :------: | :------: | :---: | :------: | :---: | :---: |
  | $D_4(1)$ | $D_3(0)$ | $D_2(1)$ | $P_3$ | $D_1(0)$ | $P_2$ | $P_1$ |

3. 求出校验码的值

  被校验数据位的海明位号等于校验该数据位的各校验位海明位号之和，校验位不需要被校验

  ![image-20220802193256668](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220802193256668.png)

  检验位$P_i$的值为第i组(由该校验位校验的数据位)所有位求异或
$$
  P_1=D_1 \oplus D_2 \oplus D_4 =0 \oplus 1 \oplus 1 = 0 \\
  P_2=D_1 \oplus D_3 \oplus D_4 =0 \oplus 0 \oplus 1 = 1 \\
  P_3=D_2 \oplus D_3 \oplus D_4 =1 \oplus 0 \oplus 1 = 0 \\
  \tag{1}
$$
  故海明码为$H_7H_6H_5H_4H_3H_2H_1=1010010$

4. 检错并纠错

	每个校验组分别利用检验位和参与形成该校验位的信息位进行奇偶校验检查，形成k个校验方程
	$$
	S_1=P_1 \oplus D_1 \oplus D_2 \oplus D_4 \\
	S_2=P_2 \oplus D_1 \oplus D_3 \oplus D_4 \\
	S_3=P_3 \oplus D_2 \oplus D_3 \oplus D_4 \\
	\tag{2}
	$$
	若为000则无错，否则出错，且这个数就是数据位的位号

## 流量控制与可靠传输机制

### 流量控制(链路层和传输层都有)

功能：控制发送速度，减少出错记录

> 链路层流量控制与传输层流量控制区别
>
> 1. 链路层流量控制是点到点的，是相邻节点(可能只有两层)之间的，其手段是接收方要是收不下就不确认
> 2. 传输层流量控制是端到端的，是主机(有五层协议的)之间的，其手段是接收方给发送方一个发送窗口大小

方法

1. 停止–等待协议(发送窗口=1，接受窗口=1)

	每发送完一个帧就停止发送，等待对方的确认，在收到确认后再发下一个帧

	![image-20220802194846481](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220802194846481.png)

2. 滑动窗口协议

	接收方收到一个正确的帧，则发送一个确认并将接受窗口后移一位；发送方收到一个正确的确认，则将发送窗口后移一位

	分类：

	- 后退N帧协议(GBN)：$发送窗口 \gt 1 \quad 接受窗口=1$
	- 选择重传协议(SR)：$发送窗口 \gt 1 \quad 接受窗口 \gt 1$

> 链路层的窗口大小在传输过程中可能不变，而传输层的窗口大小可能改变

### 可靠传输、流量控制、滑动窗口之间的关系

可靠传输：发送方发啥，接收方收啥

流量控制：控制发送速率，使接收方能有足够的空间来接受每个帧

滑动窗口：解决可靠传输和流量控制问题

### 停止等待协议

> ![image-20220802195520682](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220802195520682.png)

#### 无差错情况

![image-20220803192730087](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220803192730087.png)

#### 有差错情况

##### 数据帧丢失或出错

发送一个帧后必须保留其副本，数据帧与确认帧必须编号

![image-20220803192935764](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220803192935764.png)

##### ACK(确认)丢失&ACK(确认)迟到

![image-20220803193219296](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220803193219296.png)

#### 性能分析

pros：简单

cons：信道利用率低

> 信道利用率
>
> 发送方在一个发送周期内，有效发送数据所需要时间占整个发送时间的比率
> $$
> 利用率=\frac{\frac{L(比特)}{C(发送方数据传输率)}}{T(发送周期)} \\
> 吞吐量=利用率*发送速率
> \tag{1}
> $$
> 例题：一个信道的数据传输率为4kb/s，单向传输时延为30ms，如果使停止等待协议的信道利用率达到80%，要求的数据帧长至少为
> $$
> \frac{\frac{L}{4kb/s}}{\frac{L}{4kb/s}+2*30ms} \ge 80% 
> \\ 
> L \ge 960kb
> \tag{2}
> $$

### ==GBN—回退N帧协议(流水线技术)==

#### 概述

> 必须扩大帧序号范围，发送方需要缓存多个分组
>
> 发送窗口：发送方维持的一组连续的允许发送的帧的序号
>
> 接收窗口：接收方维持的一组连续的允许接收的帧的序号

GBN中$发送窗口 \gt 1 \quad 接受窗口=1$，当收到确认后发送窗口向后移动，==存在累计确认，偶尔捎带确认==

> 累计确认：确认帧序列为n，n号与n号之前的所有帧都被发送方确认收到
>
> 捎带确认：接收方在ACK上放一些数据
>
> GBN发送方要做的事情
>
> 1. 上层调用
>
> 	上层要发送数据时，发送方先检查发送窗口是否满，若未满则生成一个帧并传输；若**满，发送方只需将数据传回上层**，让上层等一会再发送。(实际上发送方可以缓存这些数据，窗口不满后再发送)
>
> 2. 收到ACK
>
> 	GBN协议中，对n号帧的确认==采用累计确认的方法==，标明接收方已经收到n号帧与n号帧之前的所有帧
>
> 3. 超时事件
>
> 	若出现超时事件，发送方**需要重传所有已发送但未确认的帧**
>
> GBN接收方要做的事情
>
> - 如果正确接收帧且按序，那接收方为n帧发送ACK，并且将数据交付给上层
> - 其余情况直接丢弃帧，并为最近按序接收的帧重新发送ACK，接收方不缓存任何失序帧，只需要维护一个信息：expectedseqnum(下一个按序接收的帧序号)
> - 只按序接收，不按序直接丢弃；确认序列保存最大的按序到达的帧

#### 运行过程

- ![image-20220803195523109](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220803195523109-16595277250251-16595277255883.png)

==Note：滑动窗口长度不能无限，接收窗口=1，发送窗口=$2^n-1$(n为采用n个比特对序列进行编号)；若发送窗口过大，接收方将无法正确区分新帧和老帧==

#### 性能分析

pros：信道利用率提高

cons：重传时需要重传所有已发送未确认的帧，传送效率低

### ==SR—选择重传协议==

#### 概述

通过设置单个确认，同时加大接受窗口，并设置接受缓存，缓存已到达的帧；SR只重传出错的帧

#### 滑动窗口

![image-20220807192128031](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220807192128031.png)

#### 一些要求

> SR发送方必须相应的三件事
>
> 1. 上层调用
>
> 	判断上层要发的数据是否在发送窗口中，若在则发送，不在则跟GBN一样要么缓存、要么交给上一层之后再传输
>
> 2. 接收方的确认
>
> 	如果收到ACK，且该序列在窗口内，则SR发送方将该帧标为已确认，若该帧在最左面则窗口向右移动到还未确认处，若窗口移动了且存在序号在窗口中的未发送帧，则发送
>
> 3. 超时重传
>
> 	对每个帧都建立时钟，超时则自动重传该帧
>
> SR接收方要做的事
>
> 即来者不拒，不管是按序到达的还是不按序到达的正确帧接收方都接受，且只有接收窗口都接受完毕了才能将帧传给上层并移动窗口
>
> 如果收到接受窗口左面的帧则直接返回确认帧，其他异常情况忽略

#### 运行过程

![image-20220807193034978](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220807193034978.png)

Note：发送窗口一般等于接收窗口(大于则会溢出，小了则没有意义)
$$
W_{T_{max}}=W_{R_{max}}=2^{n-1}
\tag{1}
$$

## ==介质访问控制==

### 概述

传输数据用的两种链路

1. 点对点式

	两个节点使用一条链路连接，无第三方

	应用：广域网、PPP协议

2. 广播式

	所有节点共用一条通信介质

	应用：早期总线型以太网，局域网

	典型拓扑结构：总线、星

介质访问控制：采用一定措施使得==两节点之间的通信不会发生相互冲突==的情况(可能在广播式链路中出现)

![介质访问控制](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/%E4%BB%8B%E8%B4%A8%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6.png)

### 信道划分介质访问控制

将使用介质的每个设备与来自同一信道上的其他设备的通信隔离开，把时域和频域资源合理分配给网络上的设备

#### 多路复用技术

把多个信号组合在一条物理信道上进行传输，使得多个PC或终端设备共享信道资源，提高信道利用率

![image-20220807200047270](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220807200047270.png)

把一条广播链路，逻辑上分成几条用于两个节点之间通信的互不干扰的子信道，即逻辑上把广播转为点对点

#### 频分多路复用FDM

用户在分到一定频率的频带后，在通信过程中将始终占用该频带

频分复用的所有用户在同样的时间占用不同的带宽(频率带宽)资源

充分利用频带资源；容易实现

![image-20220808192510118](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220808192510118.png)

#### 时分多路复用TDM

![image-20220808192605298](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220808192605298.png)

#### 统计时分复用STDM

改进的时分复用

![image-20220808192723448](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220808192723448.png)
$$
\begin{aligned}
& v=8kb/s \\
& 对TDM \quad v_i=2kb/s \quad 每个资源只能用\frac{1}{4} \\
& 对STDM \quad v_i=8kb/s \quad 最高
\end{aligned}
\tag{1}
$$

#### 波分多路复用WDM

==波分多路复用=光的频分多路复用==

因为一根光纤中传输不同波长光信号，由于波长(频率)不同，所以各路光互不干扰，最后使用波长分解复用器，将各路波长分解出来

![image-20220808193303662](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220808193303662.png)

#### 码分多路复用CDM

![image-20220808193508388](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220808193508388.png)

### 随机访问介质访问控制

所有用户都可随时发送数据，可占全部带宽

#### ALOHA协议

##### 纯ALOHA协议

思想：不监听信道，不按时间槽发送，随机发送，想发就发

每个帧在到达后，在缓存中等小于$T_0$时间后才能发送出去

冲突如何检测：如果发生冲突，接收方就会检测出冲突然后不予确认(NAK或不发)，发送方在一定时间收不到就判定发生冲突：

冲突如何解决：超时后等一随机时间再发，可能立刻发也可能过一会再发

> 吞吐量：$S=Ge^{-2G}$，G为$T_0$时间内所有站点发送成功的和未成功而重传的帧数，S为吞吐量，其max值为$G=0.5$时$S=0.184$，可见吞吐量巨低
>
> ![image-20220808194602215](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220808194602215.png)

##### 时隙ALOHA协议

思想：将时间分为若干时间片，所有用户在时间片开始时刻同步接入网络信道，若发送冲突，则必须等到下一个时间片开始时刻再发送

![image-20220808194803277](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220808194803277.png)

> 时隙ALOHA吞吐量大约是纯ALOHA协议的2倍，即0.368

#### CSMA协议(载波监听多路访问协议)—先听再说

CS：载波监听，每个站在**发送数据之前**要检查一下总线上是否有其他计算机在发送数据

> 当几个站同时发数据时，线路上可能会出现电压超过阈值的情况，我们将这种时刻看成出现碰撞

MA：多点接入，表示许多计算机以**多点接入的方式连接在一根总线上**

思想：发送前先监听信道，空闲则发送完整帧，忙则推迟发送

![CSMA协议](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/CSMA%E5%8D%8F%E8%AE%AE-16601305757642.png)

> 三种不同类型的CSMA协议比较
>
> | 信道状态 |           1-坚持CSMA           |               非坚持CSMA               |                          p-坚持CSMA                          |
> | :------: | :----------------------------: | :------------------------------------: | :----------------------------------------------------------: |
> |   空闲   | 信道空闲则直接发送，不需要等待 |     信道空闲则直接发送，不需要等待     | 信道空闲则以p概率直接发送，以1-p概率等到下一个时间槽再发送(p=1时退化成1-坚持CSMA) |
> |    忙    |          忙则一直监听          | 忙则放弃监听，等待随机一端时间后再监听 |                    忙则一直监听，直到空闲                    |

#### CSMA/CD协议(载波监听多点接入/碰撞检测协议)—边说边听

采用隐式ACK(无人确认)，CSMA+CD(碰撞检测)

CS：载波监听，每个站在**发送数据之前**和**发送数据时**要检查一下总线上是否有其他计算机在发送数据

MA：多点接入，表示许多计算机以多点接入的方式连接在一根总线上(总线型网络)

CD：碰撞检测(冲突检测)，“**边发送边监听**”，适配器边发送数据边检测信道上信号电压的变化情况，以便判断自己在发送数据时其他站是否也在发送数据(**半双工网络**)

##### 传播时延对载波监听的影响

即在超过RTT的时间内还未检测到碰撞，则此次发送一定没有碰撞

![image-20220810193309070](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220810193309070.png)

##### 如何确定碰撞发送后重传时机

截断二进制指数规避算法

1. 确定基本退避(推迟)时间为争用期$2\tau=1RTT$
2. 定义参数$k$，它等于重传次数，但$k$不超过10，即$k=min(重传次数，10)$
3. 从离散的整数集合${0,1,2,\dots,2^k-1}$中随机取一个数$r$，重传推迟时间是$2 \tau * r$
4. 当重传次数超过16次还不成功时，视为网络拥堵，认为该帧永远无法发出，抛弃此帧并向上层报错

> ![image-20220810193900853](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220810193900853.png)
> $$
> \begin{aligned}
> & \because 11 \gt 10 \\
> & \therefore k=10 \qquad \therefore 0-2^{10}-1
> \end{aligned}
> \tag{1}
> $$

##### 最小帧长问题

用来在检测到碰撞时可以掐断传输，若过短则可能检测到碰撞时已经发完了

==帧的传输时延至少要两倍于信号(数字或模拟)在总线中的传播时延==
$$
\begin{aligned}
& \because \frac{帧长}{数据传输速率} \ge 2 \tau=1RTT \\
& \therefore 帧长 \ge 2 \tau * 数据传输速率
\end{aligned}
\tag{1}
$$
**以太网最短帧长为64B**，小于64B的一律视为无效帧

#### CSMA/CA协议(载波监听多点接入/碰撞避免协议)—边说边听

CA多用于无线，无法360°检测碰撞，存在隐蔽站

使用显式ACK

> 隐蔽站：三个结点A、B、C
>
> 对A来说C就是一个隐蔽站，当A、C都检测到信道空闲时，同时向B发信号就会冲突

##### 原理

1. 发送数据前，先检测信道是否空闲
2. 空闲则发出**RTS(request to send)**，**RTS**包括**发送端的地址、接受端的地址、下一份数据将持续发送的时间等信息**，信道忙则等待  
3. 接受端收到**RTS**后，将响应**CTS(clear to send)**
4. 发送端收到**CTS**后，开始发送数据帧(同时预约信道：发送方告诉其他站点自己要传多久数据)
5. 接收端收到数据帧后，将用CRC(循环冗余检验)来检验数据是否正确，正确则响应**ACK**帧
6. **发送方收到ACK就可以进行下一个数据帧的发送，若没有就一直重传至规定重发次数为止**(采用**二进制指数规避算法**来确定随机的推迟时间)

主要有三个内容：预约信道，ACK确认帧，RTS/CTS帧  

#### ALOHA、CSMA、CSMA/CD、CSMA/CA对比学习

1. ALOHA协议可以分为纯ALOHA协议(想啥时候发就啥时候发)和时隙ALOHA协议(在同步时间片内随便发)，这两种协议都可以看成想发啥发啥，其主要的缺点是吞吐量低，分别是0.184和0.368

2. CSMA、CSMA/CD、CSMA/CA协议本质思想是一致的，都是边听边说

	CSMA主要有三种分别是1-坚持CSMA、非坚持CSMA和p-坚持CSMA，1-坚持CSMA特点是信道空闲就直接发忙的时候也要一直听直到空闲，而非坚持CSMA特点是若信道忙则等待一个随机时间后再听，p-坚持CSMA则是在信道空闲时以p概率直接发送已1-p概率等到下一个时间槽再发(若p=1则p-坚持退化为1-坚持)；**CSMA协议与其余两种协议的区别主要在于若出现碰撞，CSMA会一直发完本帧，而CSMA/CD和CSMA/CA则会在检测到出现碰撞时停止发送**

	CSMA/CD协议和CSMA/CA协议的异同点主要在于

	- 相同点：CSMA/CD和CSMA/CA都从属于CSMA协议的思路，都是先听再说
	- 不同点
		1. 传输介质不同：CSMA/CD协议用于总线式以太网(有线)，而CSMA/CA协议用于无线局域网(无线)
		2. 载波检测方式不同：CSMA/CD通过电缆中电压高低来检测；而CSMA/CA通过能量检测(ED)、载波检测(CS)和能量载波混合检测三种方式检测信道空闲的方式
		3. CSMA/CD检测冲突，CSMA/CA避免冲突，二者出现冲突后都会进行有上限的重传
		4. CSMA/CD采用隐式ACK无人确认，CSMA/CA采用显式确认真有人确认

### 轮询访问介质访问控制                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  

信道划分介质访问控制(MAC)协议：基于多路复用技术划分资源；网络负载重则共享信道效率高，网络负载轻则共享信道效率低

随机访问介质访问能控制协议：用户根据意愿随意发送资源，发送信息时可独占信道带宽；网络负载重则产生冲突，网络负载轻则信道效率高

轮询访问介质访问控制：上述两者结合，可分为轮询协议和令牌传递协议

#### 轮询协议

主节点轮流邀请从属结点发送数据

> 存在轮询开销(每次轮询都要发一条数据帧)，等待延迟(等前面的)，单点故障(主节点宕机就完蛋)

#### 令牌传递协议

![image-20220812192712530](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220812192712530.png)

令牌环网：逻辑上是环，物理上是总线型

TCU转发器：传输数据帧时传递接口(转发接口)，传递所有接入的帧，为接入主机提供数据接口

令牌：特殊格式的MAC(介质访问控制)控制帧，不含有任何信息；控制信道使用，确保同一时刻只有一个结点能独占信道

**无碰撞，无冲突**

##### 工作流程

![image-20220812193119761](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220812193119761.png)

在一定时间内占有令牌

##### 存在问题

有令牌开销，等待延迟和单点故障

> 应用于令牌环网，采用令牌传递的网络常用于**负载较重、通信量较大**的网络中

## 局域网

### 局域网的基本概念和体系结构

#### 概念与特点

局域网指在某一区域内由多台计算机互联成的计算机组

特点

1. **覆盖地理范围小**，只在一个相对独立的局部范围内互联，如一座或集中的建筑群中
2. 使用专门铺设的传输介质(双绞线、同轴电缆)进行联网，**数据传输速率高(10Mb/s-10Gb/s)**
3. **通信延迟时间短，误码率低，可靠性较高**
4. 各站为平等关系，共享传输信道
5. 多采用分布式控制和广播室通信，**能进行广播和组播**

决定局域网的主要要素为：**网络拓扑，传输介质与介质访问控制方法**

#### 网络拓扑

1. 星型拓扑—中间有集线器，n个主机n条线

	中间结点为控制中心，任意两点通信只需要两步，传输速度快

	网络构形简单，建网简单，便于控制和管理

	网络可靠性低，共享能力差，存在单点故障问题

2. 总线型拓扑—**常用，优势大造价低，以太网是逻辑上的总线型**

	网络可靠性高，网络结点间响应速度快，共享资源能力强

	设备投入量少，成本低，安装快

	存在单点故障问题

3. 环型拓扑

	系统中通信设备和线路比较节省

	存在单点故障问题，不便于扩展

	系统响应时延长，且信息传输效率相对较低

4. 树形拓扑

	易于扩展，易于隔离错误

	容易单点故障

后两者一但确定，通信方向就随着确定

#### 传输介质

![局域网](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/%E5%B1%80%E5%9F%9F%E7%BD%91.png)

#### 介质访问控制协议

1. CSMA/CD

	常用于总线型局域网和树形网络

2. 令牌总线

	常用于总线型局域网和树形网络

3. 令牌环

	用于环形局域网

#### 分类–按介质访问控制协议分

1. 以太网

	标准以太网(10Mbps)，快速(100Mbps)，千兆(1000Mbps)，10G以太网(10Gbps)

	都符合IEEE802.3

	逻辑拓扑为总线物理拓扑为星型，使用CSMA/CD协议

2. 令牌环网

	物理上星，逻辑上环（已淘汰）

3. FDDI网—光纤分布式

	物理上双环，逻辑上环

4. ATM网

	**单元交换技术，用53字节固定长度单元交换**

5. 无线局域网WLAN

	Wifi是一种WLAN实现技术，IEEE802.11

#### IEEE802标准

![image-20220812195320274](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220812195320274.png)

#### MAC子层和LLC子层

![image-20220812195438550](%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%87%8D%E8%A6%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.assets/image-20220812195438550.png)

总而言之LLC子层是数据链路层与网络层相关的一部分，而MAC子层是与物理层相关的一部分

### 以太网与IEEE802.3